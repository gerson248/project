!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/fire"),require("@angular/common")):"function"==typeof define&&define.amd?define("@angular/fire/performance",["exports","@angular/core","rxjs","rxjs/operators","@angular/fire","@angular/common"],n):n(((e="undefined"!=typeof globalThis?globalThis:e||self).angular=e.angular||{},e.angular.fire=e.angular.fire||{},e.angular.fire.performance={}),e.ng.core,e.rxjs,e.rxjs.operators,e.angular.fire,e.ng.common)}(this,(function(e,n,r,t,o,i){"use strict";var a=new n.InjectionToken("angularfire2.performance.auto_trace"),u=new n.InjectionToken("angularfire2.performance.instrumentationEnabled"),c=new n.InjectionToken("angularfire2.performance.dataCollectionEnabled"),s=function(e,n,a,u,c){return this.zone=u,this.performance=r.of(void 0).pipe(t.switchMap((function(){return i.isPlatformBrowser(c)?u.runOutsideAngular((function(){return import("firebase/performance")})):r.EMPTY})),t.map((function(){return o.ɵfetchInstance("performance","AngularFirePerformance",e,(function(){var r=u.runOutsideAngular((function(){return e.performance()}));return!1===n&&(r.instrumentationEnabled=!1),!1===a&&(r.dataCollectionEnabled=!1),r}),[n,a])})),t.shareReplay({bufferSize:1,refCount:!1})),o.ɵlazySDKProxy(this,this.performance,u)};s.decorators=[{type:n.Injectable,args:[{providedIn:"any"}]}],s.ctorParameters=function(){return[{type:o.FirebaseApp},{type:void 0,decorators:[{type:n.Optional},{type:n.Inject,args:[u]}]},{type:void 0,decorators:[{type:n.Optional},{type:n.Inject,args:[c]}]},{type:n.NgZone},{type:Object,decorators:[{type:n.Inject,args:[n.PLATFORM_ID]}]}]},s.ɵprov=n.ɵɵdefineInjectable({factory:function(){return new s(n.ɵɵinject(o.FirebaseApp),n.ɵɵinject(u,8),n.ɵɵinject(c,8),n.ɵɵinject(n.NgZone),n.ɵɵinject(n.PLATFORM_ID))},token:s,providedIn:"any"});var f=function(e){if("undefined"!=typeof window&&window.performance){var n=window.performance.getEntriesByName(e,"measure")||[],t="_"+e+"Start["+n.length+"]",o="_"+e+"End["+n.length+"]";return new r.Observable((function(n){return window.performance.mark(t),n.next(),{unsubscribe:function(){window.performance.mark(o),window.performance.measure(e,t,o)}}}))}return r.EMPTY};o.ɵapplyMixins(s,[{trace:null,instrumentationEnabled:null,dataCollectionEnabled:null}]);var p="_isStableStart",l="_isStableEnd";var b=!("undefined"==typeof window||!window.performance||(window.performance.mark(p),0)),d=function(){function e(e){b&&(this.disposable=e.isStable.pipe(t.first((function(e){return e})),t.tap((function(){window.performance.mark(l),window.performance.measure("isStable",p,l)}))).subscribe())}return e.prototype.ngOnDestroy=function(){this.disposable&&this.disposable.unsubscribe()},e}();d.decorators=[{type:n.Injectable}],d.ctorParameters=function(){return[{type:n.ApplicationRef}]};var m=function(e,n){e.dataCollectionEnabled.then((function(){}))};m.decorators=[{type:n.NgModule,args:[{providers:[s]}]}],m.ctorParameters=function(){return[{type:s},{type:d,decorators:[{type:n.Optional}]}]},e.AUTOMATICALLY_TRACE_CORE_NG_METRICS=a,e.AngularFirePerformance=s,e.AngularFirePerformanceModule=m,e.DATA_COLLECTION_ENABLED=c,e.INSTRUMENTATION_ENABLED=u,e.PerformanceMonitoringService=d,e.trace=function(e){return function(n){return new r.Observable((function(r){var o=f(e).subscribe();return n.pipe(t.tap((function(){return o.unsubscribe()}),(function(){}),(function(){return o.unsubscribe()}))).subscribe(r)}))}},e.traceUntil=function(e,n,o){return function(i){return new r.Observable((function(r){var a=f(e).subscribe();return i.pipe(t.tap((function(e){return n(e)&&a.unsubscribe()}),(function(){}),(function(){return o&&o.orComplete&&a.unsubscribe()}))).subscribe(r)}))}},e.traceUntilComplete=function(e){return function(n){return new r.Observable((function(r){var o=f(e).subscribe();return n.pipe(t.tap((function(){}),(function(){}),(function(){return o.unsubscribe()}))).subscribe(r)}))}},e.traceUntilFirst=function(e){return function(n){return new r.Observable((function(r){var o=f(e).subscribe();return n.pipe(t.tap((function(){return o.unsubscribe()}),(function(){}),(function(){}))).subscribe(r)}))}},e.traceWhile=function(e,n,o){return function(i){return new r.Observable((function(r){var a;return i.pipe(t.tap((function(r){n(r)?a=a||f(e).subscribe():(a&&a.unsubscribe(),a=void 0)}),(function(){}),(function(){return o&&o.orComplete&&a&&a.unsubscribe()}))).subscribe(r)}))}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-fire-performance.umd.min.js.map